
<!DOCTYPE html>

<html lang="ru">

<head>

Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

Â  Â  <meta charset="UTF-8" />

Â  Â  <title>faw_rockpaperscissors: pve</title>

Â  Â  <link rel="icon" href="../icon.png">

Â  Â  <style>

Â  Â  Â  Â  /* ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ÑÑ‚Ğ¸Ğ»Ğ¸ - Ğ±Ğ»Ğ¸Ğ¶Ğµ Ğº PvE */

Â  Â  Â  Â  body {

Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  background-color: #121212;

Â  Â  Â  Â  Â  Â  color: #ddd;

Â  Â  Â  Â  Â  Â  margin: 0;

Â  Â  Â  Â  Â  Â  padding: 20px;

Â  Â  Â  Â  }



Â  Â  Â  Â  h1 {

Â  Â  Â  Â  Â  Â  margin-bottom: 10px;

Â  Â  Â  Â  Â  Â  color: #aaddff;

Â  Â  Â  Â  Â  Â  text-shadow: 0 0 6px #88ccff88;

Â  Â  Â  Â  }



Â  Â  Â  Â  #gameWrapper {

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  justify-content: center;

Â  Â  Â  Â  Â  Â  gap: 20px;

Â  Â  Â  Â  Â  Â  align-items: flex-start;

Â  Â  Â  Â  Â  Â  max-width: 1100px;

Â  Â  Â  Â  Â  Â  margin: 0 auto;

Â  Â  Â  Â  Â  Â  flex-wrap: wrap;

Â  Â  Â  Â  Â  Â  padding: 0 10px;

Â  Â  Â  Â  }



Â  Â  Â  Â  #gameControls {

Â  Â  Â  Â  Â  Â  background-color: #1a1a1a;

Â  Â  Â  Â  Â  Â  padding: 15px;

Â  Â  Â  Â  Â  Â  border-radius: 8px;

Â  Â  Â  Â  Â  Â  width: 260px;

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  flex-direction: column;

Â  Â  Â  Â  Â  Â  gap: 20px;

Â  Â  Â  Â  Â  Â  border: 1px solid #333;

Â  Â  Â  Â  Â  Â  color: #ccc;

Â  Â  Â  Â  }



Â  Â  Â  Â  .player-controls {

Â  Â  Â  Â  Â  Â  background-color: #2a2a2a;

Â  Â  Â  Â  Â  Â  padding: 12px;

Â  Â  Â  Â  Â  Â  border-radius: 8px;

Â  Â  Â  Â  }



Â  Â  Â  Â  .type-buttons {

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  justify-content: center;

Â  Â  Â  Â  Â  Â  gap: 10px;

Â  Â  Â  Â  Â  Â  margin-bottom: 10px;

Â  Â  Â  Â  Â  Â  flex-wrap: wrap;

Â  Â  Â  Â  }



Â  Â  Â  Â  .type-button {

Â  Â  Â  Â  Â  Â  font-size: 1.1rem;

Â  Â  Â  Â  Â  Â  padding: 10px 16px;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  Â  Â  border: 2px solid #555;

Â  Â  Â  Â  Â  Â  border-radius: 8px;

Â  Â  Â  Â  Â  Â  background-color: #2a2a2a;

Â  Â  Â  Â  Â  Â  color: #ddd;

Â  Â  Â  Â  Â  Â  user-select: none;

Â  Â  Â  Â  Â  Â  transition: background-color 0.3s, border-color 0.3s, color 0.3s;

Â  Â  Â  Â  Â  Â  width: auto;

Â  Â  Â  Â  Â  Â  min-width: 70px;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  display: inline-block;

Â  Â  Â  Â  Â  Â  touch-action: manipulation;

Â  Â  Â  Â  Â  Â  -webkit-tap-highlight-color: rgba(255, 255, 255, 0.2);

Â  Â  Â  Â  }



Â  Â  Â  Â  .type-button:hover {

Â  Â  Â  Â  Â  Â  background-color: #444;

Â  Â  Â  Â  Â  Â  border-color: #88ccff;

Â  Â  Â  Â  Â  Â  color: #aaddff;

Â  Â  Â  Â  }



Â  Â  Â  Â  .type-button.selected {

Â  Â  Â  Â  Â  Â  background-color: #555;

Â  Â  Â  Â  Â  Â  border-color: #88ccff;

Â  Â  Â  Â  Â  Â  color: #aaddff;

Â  Â  Â  Â  Â  Â  font-weight: bold;

Â  Â  Â  Â  }



Â  Â  Â  Â  #player1Controls .type-button.selected {

Â  Â  Â  Â  Â  Â  border-color: #88ccff; /* ÑĞ²ĞµÑ‚Ğ»Ğ¾-Ğ³Ğ¾Ğ»ÑƒĞ±Ğ¾Ğ¹ */

Â  Â  Â  Â  }



Â  Â  Â  Â  #player2Controls .type-button.selected {

Â  Â  Â  Â  Â  Â  border-color: #ff6347; /* Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ½Ñ‹Ğ¹, ĞºĞ°Ğº Ğ² PvE */

Â  Â  Â  Â  Â  Â  color: #ff9b90;

Â  Â  Â  Â  }



Â  Â  Â  Â  #gameCanvas {

Â  Â  Â  Â  Â  Â  background-color: #1e1e1e;

Â  Â  Â  Â  Â  Â  border: 1px solid #444;

Â  Â  Â  Â  Â  Â  border-radius: 8px;

Â  Â  Â  Â  Â  Â  cursor: crosshair;

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  max-width: 700px;

Â  Â  Â  Â  Â  Â  height: auto;

Â  Â  Â  Â  Â  Â  touch-action: manipulation;

Â  Â  Â  Â  }



Â  Â  Â  Â  button {

Â  Â  Â  Â  Â  Â  font-size: 1.1rem;

Â  Â  Â  Â  Â  Â  margin: 5px 0;

Â  Â  Â  Â  Â  Â  padding: 10px 20px;

Â  Â  Â  Â  Â  Â  border-radius: 10px;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  Â  Â  background-color: #3a8f3a;

Â  Â  Â  Â  Â  Â  color: white;

Â  Â  Â  Â  Â  Â  transition: background-color 0.3s;

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  touch-action: manipulation;

Â  Â  Â  Â  Â  Â  -webkit-tap-highlight-color: rgba(255, 255, 255, 0.2);

Â  Â  Â  Â  }



Â  Â  Â  Â  button:hover {

Â  Â  Â  Â  Â  Â  background-color: #5bb75b;

Â  Â  Â  Â  }



Â  Â  Â  Â  #actions p {

Â  Â  Â  Â  Â  Â  margin: 8px 0;

Â  Â  Â  Â  Â  Â  font-size: 18px;

Â  Â  Â  Â  Â  Â  font-weight: bold;

Â  Â  Â  Â  Â  Â  color: #ddd;

Â  Â  Â  Â  }



Â  Â  Â  Â  .type-button.hidden {

Â  Â  Â  Â  Â  Â  display: none;

Â  Â  Â  Â  }



Â  Â  Â  Â  .menu-button {

Â  Â  Â  Â  Â  Â  display: inline-block;

Â  Â  Â  Â  Â  Â  font-size: 1rem;

Â  Â  Â  Â  Â  Â  margin: 10px 0 0 0;

Â  Â  Â  Â  Â  Â  padding: 12px 24px;

Â  Â  Â  Â  Â  Â  border-radius: 10px;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  text-decoration: none;

Â  Â  Â  Â  Â  Â  background-color: #555555;

Â  Â  Â  Â  Â  Â  color: #ddd;

Â  Â  Â  Â  Â  Â  font-weight: 600;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  transition: background-color 0.3s ease;

Â  Â  Â  Â  Â  Â  user-select: none;

Â  Â  Â  Â  Â  Â  width: auto;

Â  Â  Â  Â  Â  Â  max-width: 200px;

Â  Â  Â  Â  }



Â  Â  Â  Â  .menu-button:hover {

Â  Â  Â  Â  Â  Â  background-color: #777777;

Â  Â  Â  Â  }



Â  Â  Â  Â  .start-button {

Â  Â  Â  Â  Â  Â  background-color: #3a8f3a;

Â  Â  Â  Â  Â  Â  color: white;

Â  Â  Â  Â  Â  Â  font-weight: bold;

Â  Â  Â  Â  }



Â  Â  Â  Â  .start-button:hover {

Â  Â  Â  Â  Â  Â  background-color: #5bb75b;

Â  Â  Â  Â  }



Â  Â  Â  Â  /* ğŸ“± ĞœĞ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ°Ñ†Ğ¸Ñ, ĞºĞ°Ğº Ğ² PvE */

Â  Â  Â  Â  @media (max-width: 768px) {

Â  Â  Â  Â  Â  Â  body {

Â  Â  Â  Â  Â  Â  Â  Â  padding: 10px;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  #gameWrapper {

Â  Â  Â  Â  Â  Â  Â  Â  flex-direction: column;

Â  Â  Â  Â  Â  Â  Â  Â  align-items: center;

Â  Â  Â  Â  Â  Â  Â  Â  padding: 0 10px;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  #gameControls {

Â  Â  Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  Â  Â  max-width: 400px;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  #gameCanvas {

Â  Â  Â  Â  Â  Â  Â  Â  width: 100% !important;

Â  Â  Â  Â  Â  Â  Â  Â  height: auto !important;

Â  Â  Â  Â  Â  Â  Â  Â  max-width: 100%;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  .type-buttons {

Â  Â  Â  Â  Â  Â  Â  Â  flex-wrap: wrap;

Â  Â  Â  Â  Â  Â  Â  Â  justify-content: center;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  .type-button {

Â  Â  Â  Â  Â  Â  Â  Â  font-size: 1rem;

Â  Â  Â  Â  Â  Â  Â  Â  min-width: 60px;

Â  Â  Â  Â  Â  Â  Â  Â  padding: 8px 12px;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  button, .menu-button {

Â  Â  Â  Â  Â  Â  Â  Â  font-size: 1rem;

Â  Â  Â  Â  Â  Â  Â  Â  padding: 12px;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  h1 {

Â  Â  Â  Â  Â  Â  Â  Â  font-size: 1.5rem;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  </style>

</head>

<body>

Â  Â  <div id="gameWrapper">

Â  Â  Â  Â  <div id="gameControls">

Â  Â  Â  Â  Â  Â  <div class="player-controls" id="player1Controls">

Â  Â  Â  Â  Â  Â  Â  Â  <h2>Ğ˜Ğ³Ñ€Ğ¾Ğº 1 (ÑĞ¸Ğ½Ğ¸Ğ¹)</h2>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="type-buttons">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-type="rock" class="type-button selected">ğŸª¨</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-type="paper" class="type-button">ğŸ“„</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-type="scissors" class="type-button">âœ‚ï¸ </button>

Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <p>Ğ®Ğ½Ğ¸Ñ‚Ñ‹: <span id="player1UnitsCount">0</span></p>

Â  Â  Â  Â  Â  Â  </div>



Â  Â  Â  Â  Â  Â  <div class="player-controls" id="player2Controls">

Â  Â  Â  Â  Â  Â  Â  Â  <h2>Ğ˜Ğ³Ñ€Ğ¾Ğº 2 (ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹)</h2>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="type-buttons">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-type="rock" class="type-button selected">ğŸª¨</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-type="paper" class="type-button">ğŸ“„</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-type="scissors" class="type-button">âœ‚ï¸ </button>

Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <p>Ğ®Ğ½Ğ¸Ñ‚Ñ‹: <span id="player2UnitsCount">0</span></p>

Â  Â  Â  Â  Â  Â  </div>



Â  Â  Â  Â  Â  Â  <div id="actions">

Â  Â  Â  Â  Â  Â  Â  Â  <p>ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¸Ğ³Ñ€Ğ¾Ğº: <strong id="activePlayer">Ğ˜Ğ³Ñ€Ğ¾Ğº 1</strong></p>

Â  Â  Â  Â  Â  Â  Â  Â  <button id="startGameBtn" class="start-button">ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¸Ğ³Ñ€Ñƒ</button>

Â  Â  Â  Â  Â  Â  Â  Â  <button id="restartGameBtn" class="start-button" style="display:none;">Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾</button>

Â  Â  Â  Â  Â  Â  Â  Â  <a href="../index.html" class="menu-button">Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ</a>

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  </div>



Â  Â  Â  Â  <canvas id="gameCanvas" width="800" height="500"></canvas>

Â  Â  </div>



Â  Â  <script>

Â  Â  Â  Â  document.addEventListener("DOMContentLoaded", function () {

Â  Â  Â  Â  Â  Â  const startButton = document.getElementById("startGameBtn");

Â  Â  Â  Â  Â  Â  const restartButton = document.getElementById("restartGameBtn");

Â  Â  Â  Â  Â  Â  const typeButtons = document.querySelectorAll(".type-buttons");



Â  Â  Â  Â  Â  Â  startButton.addEventListener("click", function () {

Â  Â  Â  Â  Â  Â  Â  Â  typeButtons.forEach(buttonGroup => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buttonGroup.style.display = "none";

Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  startButton.style.display = "none";

Â  Â  Â  Â  Â  Â  Â  Â  restartButton.style.display = "inline-block";

Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  restartButton.addEventListener("click", function () {

Â  Â  Â  Â  Â  Â  Â  Â  typeButtons.forEach(buttonGroup => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buttonGroup.style.display = "flex"; // Ğ¸Ğ»Ğ¸ "block" â€” Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ²Ğ°ÑˆĞµĞ¹ Ğ²ĞµÑ€ÑÑ‚ĞºĞ¸

Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  restartButton.style.display = "none";

Â  Â  Â  Â  Â  Â  Â  Â  startButton.style.display = "inline-block";

Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  });



Â  Â  Â  Â  const Game = {

Â  Â  Â  Â  Â  Â  WIDTH: 800,

Â  Â  Â  Â  Â  Â  HEIGHT: 500,

Â  Â  Â  Â  Â  Â  TYPES: ["rock", "paper", "scissors"],

Â  Â  Â  Â  Â  Â  EMOJIS: { rock: "ğŸª¨", paper: "ğŸ“„", scissors: "âœ‚ï¸" },

Â  Â  Â  Â  Â  Â  COLORS: { player1: "#87CEFA", player2: "#FF6347" },

Â  Â  Â  Â  Â  Â  units: [],

Â  Â  Â  Â  Â  Â  placing: true,

Â  Â  Â  Â  Â  Â  activePlayer: "player1",

Â  Â  Â  Â  Â  Â  selectedTypes: { player1: "rock", player2: "rock" },

Â  Â  Â  Â  Â  Â  loop: null,

Â  Â  Â  Â  Â  Â  winnerText: "",

Â  Â  Â  Â  Â  Â  winnerPlayer: null,

Â  Â  Â  Â  Â  Â  isRunning: false,

Â  Â  Â  Â  };



Â  Â  Â  Â  (function(ns) {

Â  Â  Â  Â  Â  Â  class Unit {

Â  Â  Â  Â  Â  Â  Â  Â  constructor(x, y, type, player) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.x = x;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.y = y;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.type = type;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.player = player;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vx = Math.random() * 2 - 1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vy = Math.random() * 2 - 1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.radius = 12;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.spawnTime = Date.now();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.nextDashTime = Date.now() + this.getRandomDashInterval();

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  getRandomDashInterval() {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return 2000 + Math.random() * 3000;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  dash() {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dashStrength = 5 + Math.random() * 10;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const speed = Math.hypot(this.vx, this.vy) || 1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vx += (this.vx / speed) * dashStrength;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vy += (this.vy / speed) * dashStrength;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.nextDashTime = Date.now() + this.getRandomDashInterval();

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  move() {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (Date.now() >= this.nextDashTime) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.dash();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let target = null;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let minDist = Infinity;



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for (const other of ns.units) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (other === this || other.player === this.player) continue;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (shouldChase(this.type, other.type) || shouldFlee(this.type, other.type)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dx = wrapDistance(this.x, other.x, ns.WIDTH);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dy = wrapDistance(this.y, other.y, ns.HEIGHT);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dist = Math.hypot(dx, dy);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dist < minDist) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  minDist = dist;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  target = other;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const baseSpeed = 1.5;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (target) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dx = wrapDistance(this.x, target.x, ns.WIDTH);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dy = wrapDistance(this.y, target.y, ns.HEIGHT);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const d = Math.hypot(dx, dy) + 0.01;



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (shouldChase(this.type, target.type)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vx += (dx / d) * baseSpeed * 0.1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vy += (dy / d) * baseSpeed * 0.1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (shouldFlee(this.type, target.type)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vx -= (dx / d) * baseSpeed * 0.1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vy -= (dy / d) * baseSpeed * 0.1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for (const other of ns.units) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (other === this || other.player !== this.player) continue;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dx = wrapDistance(this.x, other.x, ns.WIDTH);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dy = wrapDistance(this.y, other.y, ns.HEIGHT);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dist = Math.hypot(dx, dy);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dist > 0 && dist < this.radius * 2) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const repulse = 1.5;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vx -= (dx / dist) * repulse * 0.05;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vy -= (dy / dist) * repulse * 0.05;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vx *= 0.95;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.vy *= 0.95;



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.x = (this.x + this.vx + ns.WIDTH) % ns.WIDTH;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.y = (this.y + this.vy + ns.HEIGHT) % ns.HEIGHT;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  draw(ctx) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.save();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.translate(this.x, this.y);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const age = Date.now() - this.spawnTime;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (age < 1000) ctx.globalAlpha = 0.5 + 0.5 * (age / 1000);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.font = "20px serif";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.textAlign = "center";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.textBaseline = "middle";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = ns.COLORS[this.player];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowBlur = 6;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = ns.COLORS[this.player];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillText(ns.EMOJIS[this.type], 0, 0);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.restore();

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  ns.Unit = Unit;



Â  Â  Â  Â  Â  Â  function wrapDistance(a, b, size) {

Â  Â  Â  Â  Â  Â  Â  Â  let d = b - a;

Â  Â  Â  Â  Â  Â  Â  Â  if (Math.abs(d) > size / 2) d -= Math.sign(d) * size;

Â  Â  Â  Â  Â  Â  Â  Â  return d;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  function shouldChase(t1, t2) {

Â  Â  Â  Â  Â  Â  Â  Â  const map = { rock: "scissors", scissors: "paper", paper: "rock" };

Â  Â  Â  Â  Â  Â  Â  Â  return map[t1] === t2;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  function shouldFlee(t1, t2) {

Â  Â  Â  Â  Â  Â  Â  Â  const map = { rock: "paper", paper: "scissors", scissors: "rock" };

Â  Â  Â  Â  Â  Â  Â  Â  return map[t1] === t2;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  function beats(t1, t2) {

Â  Â  Â  Â  Â  Â  Â  Â  return shouldChase(t1, t2);

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  function resolveConflict(a, b) {

Â  Â  Â  Â  Â  Â  Â  Â  let changed = false;

Â  Â  Â  Â  Â  Â  Â  Â  if (beats(a.type, b.type)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  b.type = a.type;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  b.player = a.player;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  changed = true;

Â  Â  Â  Â  Â  Â  Â  Â  } else if (beats(b.type, a.type)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  a.type = b.type;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  a.player = b.player;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  changed = true;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  if (changed && Game.ui && typeof Game.ui.updateUI === "function") {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Game.ui.updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  ns.wrapDistance = wrapDistance;

Â  Â  Â  Â  Â  Â  ns.shouldChase = shouldChase;

Â  Â  Â  Â  Â  Â  ns.shouldFlee = shouldFlee;



Â  Â  Â  Â  Â  Â  ns.update = function() {

Â  Â  Â  Â  Â  Â  Â  Â  if (!ns.isRunning) return;

Â  Â  Â  Â  Â  Â  Â  Â  for (let u of ns.units) u.move();



Â  Â  Â  Â  Â  Â  Â  Â  for (let i = 0; i < ns.units.length; i++) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for (let j = i + 1; j < ns.units.length; j++) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const a = ns.units[i];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const b = ns.units[j];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (a.player === b.player) continue;



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dx = wrapDistance(a.x, b.x, ns.WIDTH);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dy = wrapDistance(a.y, b.y, ns.HEIGHT);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dist = Math.hypot(dx, dy);



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dist < 24 && a.type !== b.type) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resolveConflict(a, b);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const overlap = 24 - dist;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const nx = dx / dist;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const ny = dy / dist;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  a.x -= nx * overlap * 0.5;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  a.y -= ny * overlap * 0.5;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  b.x += nx * overlap * 0.5;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  b.y += ny * overlap * 0.5;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  checkWinCondition();

Â  Â  Â  Â  Â  Â  };



Â  Â  Â  Â  Â  Â  function checkWinCondition() {

Â  Â  Â  Â  Â  Â  Â  Â  if (ns.placing) return;



Â  Â  Â  Â  Â  Â  Â  Â  const p1Units = ns.units.filter(u => u.player === "player1");

Â  Â  Â  Â  Â  Â  Â  Â  const p2Units = ns.units.filter(u => u.player === "player2");



Â  Â  Â  Â  Â  Â  Â  Â  if (p1Units.length === 0 && p2Units.length === 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showWinner("ĞĞ¸Ñ‡ÑŒÑ!", null);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cancelAnimationFrame(ns.loop);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  if (p1Units.length === 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showWinner("Ğ˜Ğ³Ñ€Ğ¾Ğº 2 Ğ¿Ğ¾Ğ±ĞµĞ´Ğ¸Ğ»!", "player2");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cancelAnimationFrame(ns.loop);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  if (p2Units.length === 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showWinner("Ğ˜Ğ³Ñ€Ğ¾Ğº 1 Ğ¿Ğ¾Ğ±ĞµĞ´Ğ¸Ğ»!", "player1");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cancelAnimationFrame(ns.loop);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° Ğ¿Ğ°Ñ‚Ğ¾Ğ²ÑƒÑ ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ñ

Â  Â  Â  Â  Â  Â  Â  Â  const p1CanBeat = p1Units.some(u1 =>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  p2Units.some(u2 => shouldChase(u1.type, u2.type))

Â  Â  Â  Â  Â  Â  Â  Â  );

Â  Â  Â  Â  Â  Â  Â  Â  const p2CanBeat = p2Units.some(u2 =>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  p1Units.some(u1 => shouldChase(u2.type, u1.type))

Â  Â  Â  Â  Â  Â  Â  Â  );



Â  Â  Â  Â  Â  Â  Â  Â  if (!p1CanBeat && !p2CanBeat) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (p1Units.length > p2Units.length) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showWinner("Ğ˜Ğ³Ñ€Ğ¾Ğº 1 Ğ¿Ğ¾Ğ±ĞµĞ´Ğ¸Ğ»!", "player1");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (p2Units.length > p1Units.length) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showWinner("Ğ˜Ğ³Ñ€Ğ¾Ğº 2 Ğ¿Ğ¾Ğ±ĞµĞ´Ğ¸Ğ»!", "player2");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showWinner("ĞĞ¸Ñ‡ÑŒÑ!", null);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cancelAnimationFrame(ns.loop);

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  function showWinner(text, player) {

Â  Â  Â  Â  Â  Â  Â  Â  ns.winnerText = text;

Â  Â  Â  Â  Â  Â  Â  Â  ns.winnerPlayer = player;

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("restartGameBtn").style.display = "block";

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("startGameBtn").style.display = "none";

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("player1Controls").style.pointerEvents = "none";

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("player2Controls").style.pointerEvents = "none";

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  })(Game);



Â  Â  Â  Â  (function(ns) {

Â  Â  Â  Â  Â  Â  const canvas = document.getElementById("gameCanvas");

Â  Â  Â  Â  Â  Â  const ctx = canvas.getContext("2d");



Â  Â  Â  Â  Â  Â  const startGameBtn = document.getElementById("startGameBtn");

Â  Â  Â  Â  Â  Â  const restartGameBtn = document.getElementById("restartGameBtn");

Â  Â  Â  Â  Â  Â  const player1Controls = document.getElementById("player1Controls");

Â  Â  Â  Â  Â  Â  const player2Controls = document.getElementById("player2Controls");



Â  Â  Â  Â  Â  Â  // ĞŸĞµÑ€ĞµĞ½ĞµÑĞµĞ¼ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑÑ‚Ğ¸Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹ ÑÑĞ´Ğ°, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¾Ğ½Ğ¸ Ğ±Ñ‹Ğ»Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ² ns

Â  Â  Â  Â  Â  Â  ns.isRunning = ns.isRunning || false;

Â  Â  Â  Â  Â  Â  ns.units = ns.units || [];

Â  Â  Â  Â  Â  Â  ns.placing = ns.placing || true;

Â  Â  Â  Â  Â  Â  ns.winnerText = ns.winnerText || "";

Â  Â  Â  Â  Â  Â  ns.winnerPlayer = ns.winnerPlayer || null;

Â  Â  Â  Â  Â  Â  ns.activePlayer = ns.activePlayer || "player1";





Â  Â  Â  Â  Â  Â  ns.spawnRandomUnits = function() {

Â  Â  Â  Â  Â  Â  Â  Â  const minUnits = 1;

Â  Â  Â  Â  Â  Â  Â  Â  const maxUnits = 5;



Â  Â  Â  Â  Â  Â  Â  Â  const allTypes = ["rock", "scissors", "paper"];



Â  Â  Â  Â  Â  Â  Â  Â  function randomInt(min, max) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return Math.floor(Math.random() * (max - min + 1)) + min;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  for (const player of ["player1", "player2"]) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const count = Math.min(randomInt(minUnits, maxUnits), allTypes.length);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const shuffledTypes = allTypes.slice().sort(() => Math.random() - 0.5);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const chosenTypes = shuffledTypes.slice(0, count);



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for (let i = 0; i < count; i++) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const x = Math.random() * ns.WIDTH;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const y = Math.random() * ns.HEIGHT;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const type = chosenTypes[i];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.units.push(new ns.Unit(x, y, type, player));

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  };



Â  Â  Â  Â  Â  Â  ns.draw = function() {

Â  Â  Â  Â  Â  Â  Â  Â  ctx.clearRect(0, 0, ns.WIDTH, ns.HEIGHT);



Â  Â  Â  Â  Â  Â  Â  Â  const gridSize = 20;

Â  Â  Â  Â  Â  Â  Â  Â  ctx.strokeStyle = 'rgba(128, 128, 128, 0.2)';

Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineWidth = 1;



Â  Â  Â  Â  Â  Â  Â  Â  for (let x = 0; x <= ns.WIDTH; x += gridSize) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.moveTo(x, 0);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(x, ns.HEIGHT);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.stroke();

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  for (let y = 0; y <= ns.HEIGHT; y += gridSize) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.moveTo(0, y);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.lineTo(ns.WIDTH, y);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.stroke();

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  for (let u of ns.units) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  u.draw(ctx);

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  if (ns.winnerText) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const centerX = ns.WIDTH / 2;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const centerY = ns.HEIGHT / 2;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = "rgba(0,0,0,0.7)";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillRect(centerX - 150, centerY - 40, 300, 80);



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.textAlign = "center";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.textBaseline = "middle";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.font = "bold 32px Arial";



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (ns.winnerPlayer === "player1") {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = "#87CEFA";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = "#00BFFF";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (ns.winnerPlayer === "player2") {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = "#FF6347";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = "#FF4500";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = "white";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowColor = "white";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowBlur = 20;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillText(ns.winnerText, centerX, centerY);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.shadowBlur = 0;

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  };



Â  Â  Â  Â  Â  Â  ns.gameLoop = function() {

Â  Â  Â  Â  Â  Â  Â  Â  ns.update();

Â  Â  Â  Â  Â  Â  Â  Â  ns.draw();

Â  Â  Â  Â  Â  Â  Â  Â  if (!ns.winnerText) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.loop = requestAnimationFrame(ns.gameLoop);

Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.isRunning = false;

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  };



Â  Â  Â  Â  Â  Â  startGameBtn.addEventListener("click", () => {

Â  Â  Â  Â  Â  Â  Â  Â  if (ns.isRunning) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  if (ns.units.length === 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.spawnRandomUnits();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.ui.updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.draw();

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  ns.placing = false;

Â  Â  Â  Â  Â  Â  Â  Â  ns.isRunning = true;



Â  Â  Â  Â  Â  Â  Â  Â  startGameBtn.style.display = "none";

Â  Â  Â  Â  Â  Â  Â  Â  player1Controls.style.pointerEvents = "none";

Â  Â  Â  Â  Â  Â  Â  Â  player2Controls.style.pointerEvents = "none";



Â  Â  Â  Â  Â  Â  Â  Â  ns.loop = requestAnimationFrame(ns.gameLoop);

Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  restartGameBtn.addEventListener("click", () => {

Â  Â  Â  Â  Â  Â  Â  Â  ns.isRunning = false;



Â  Â  Â  Â  Â  Â  Â  Â  ns.units = [];

Â  Â  Â  Â  Â  Â  Â  Â  ns.placing = true;

Â  Â  Â  Â  Â  Â  Â  Â  ns.winnerText = "";

Â  Â  Â  Â  Â  Â  Â  Â  ns.winnerPlayer = null;

Â  Â  Â  Â  Â  Â  Â  Â  ns.activePlayer = "player1";



Â  Â  Â  Â  Â  Â  Â  Â  const activePlayerLabel = document.getElementById("activePlayer");

Â  Â  Â  Â  Â  Â  Â  Â  activePlayerLabel.textContent = "Ğ˜Ğ³Ñ€Ğ¾Ğº 1";



Â  Â  Â  Â  Â  Â  Â  Â  startGameBtn.style.display = "inline-block";

Â  Â  Â  Â  Â  Â  Â  Â  player1Controls.style.pointerEvents = "auto";

Â  Â  Â  Â  Â  Â  Â  Â  player2Controls.style.pointerEvents = "auto";

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("player1UnitsCount").textContent = "0";

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("player2UnitsCount").textContent = "0";

Â  Â  Â  Â  Â  Â  Â  Â  restartGameBtn.style.display = "none";



Â  Â  Â  Â  Â  Â  Â  Â  ns.ui.updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  ns.draw();

Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  canvas.addEventListener("click", (e) => {

Â  Â  Â  Â  Â  Â  Â  Â  if (!ns.placing) return;



Â  Â  Â  Â  Â  Â  Â  Â  const rect = canvas.getBoundingClientRect();

Â  Â  Â  Â  Â  Â  Â  Â  const x = e.clientX - rect.left;

Â  Â  Â  Â  Â  Â  Â  Â  const y = e.clientY - rect.top;



Â  Â  Â  Â  Â  Â  Â  Â  let clickedUnitIndex = -1;

Â  Â  Â  Â  Â  Â  Â  Â  for (let i = ns.units.length - 1; i >= 0; i--) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const u = ns.units[i];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dx = u.x - x;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dy = u.y - y;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const distance = Math.sqrt(dx*dx + dy*dy);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (distance <= 15) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clickedUnitIndex = i;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  if (clickedUnitIndex >= 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.units.splice(clickedUnitIndex, 1);

Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const type = ns.selectedTypes[ns.activePlayer];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.units.push(new ns.Unit(x, y, type, ns.activePlayer));

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  ns.ui.updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  ns.draw();

Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  canvas.addEventListener("touchstart", (e) => {

Â  Â  Â  Â  Â  Â  Â  Â  if (!ns.placing) return;



Â  Â  Â  Â  Â  Â  Â  Â  e.preventDefault();



Â  Â  Â  Â  Â  Â  Â  Â  const rect = canvas.getBoundingClientRect();

Â  Â  Â  Â  Â  Â  Â  Â  const touch = e.touches[0];



Â  Â  Â  Â  Â  Â  Â  Â  const scaleX = canvas.width / rect.width;

Â  Â  Â  Â  Â  Â  Â  Â  const scaleY = canvas.height / rect.height;



Â  Â  Â  Â  Â  Â  Â  Â  const x = (touch.clientX - rect.left) * scaleX;

Â  Â  Â  Â  Â  Â  Â  Â  const y = (touch.clientY - rect.top) * scaleY;



Â  Â  Â  Â  Â  Â  Â  Â  let clickedUnitIndex = -1;

Â  Â  Â  Â  Â  Â  Â  Â  for (let i = ns.units.length - 1; i >= 0; i--) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const u = ns.units[i];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dx = u.x - x;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dy = u.y - y;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const distance = Math.sqrt(dx*dx + dy*dy);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (distance <= 15) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clickedUnitIndex = i;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  if (clickedUnitIndex >= 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.units.splice(clickedUnitIndex, 1);

Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const type = ns.selectedTypes[ns.activePlayer];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.units.push(new ns.Unit(x, y, type, ns.activePlayer));

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  ns.ui.updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  ns.draw();

Â  Â  Â  Â  Â  Â  }, { passive: false });



Â  Â  Â  Â  Â  Â  canvas.width = 700;

Â  Â  Â  Â  Â  Â  canvas.height = 500;



Â  Â  Â  Â  Â  Â  ns.WIDTH = canvas.width;

Â  Â  Â  Â  Â  Â  ns.HEIGHT = canvas.height;

Â  Â  Â  Â  })(Game);



Â  Â  Â  Â  (function(ns) {

Â  Â  Â  Â  Â  Â  const player1Controls = document.getElementById("player1Controls");

Â  Â  Â  Â  Â  Â  const player2Controls = document.getElementById("player2Controls");

Â  Â  Â  Â  Â  Â  const activePlayerLabel = document.getElementById("activePlayer");

Â  Â  Â  Â  Â  Â  const player1UnitsCountSpan = document.getElementById("player1UnitsCount");

Â  Â  Â  Â  Â  Â  const player2UnitsCountSpan = document.getElementById("player2UnitsCount");



Â  Â  Â  Â  Â  Â  function updatePlayerButtons(container, player) {

Â  Â  Â  Â  Â  Â  Â  Â  const buttons = container.querySelectorAll(".type-button");

Â  Â  Â  Â  Â  Â  Â  Â  buttons.forEach(btn => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const type = btn.getAttribute("data-type");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.remove("hidden");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (player === ns.activePlayer) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.toggle("selected", ns.selectedTypes[player] === type);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.remove("selected");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  function updateUI() {

Â  Â  Â  Â  Â  Â  Â  Â  activePlayerLabel.textContent = ns.activePlayer === "player1" ? "Ğ˜Ğ³Ñ€Ğ¾Ğº 1" : "Ğ˜Ğ³Ñ€Ğ¾Ğº 2";

Â  Â  Â  Â  Â  Â  Â  Â  updatePlayerButtons(player1Controls, "player1");

Â  Â  Â  Â  Â  Â  Â  Â  updatePlayerButtons(player2Controls, "player2");



Â  Â  Â  Â  Â  Â  Â  Â  const p1Count = ns.units.filter(u => u.player === "player1").length;

Â  Â  Â  Â  Â  Â  Â  Â  const p2Count = ns.units.filter(u => u.player === "player2").length;

Â  Â  Â  Â  Â  Â  Â  Â  player1UnitsCountSpan.textContent = p1Count;

Â  Â  Â  Â  Â  Â  Â  Â  player2UnitsCountSpan.textContent = p2Count;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  function setupTypeButtons() {

Â  Â  Â  Â  Â  Â  Â  Â  const allButtons = [...player1Controls.querySelectorAll(".type-button"),

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ...player2Controls.querySelectorAll(".type-button")];

Â  Â  Â  Â  Â  Â  Â  Â  allButtons.forEach(btn => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.addEventListener("click", () => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const parent = btn.closest(".player-controls");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const player = parent.id === "player1Controls" ? "player1" : "player2";



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.activePlayer = player;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.selectedTypes[player] = btn.getAttribute("data-type");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.addEventListener("touchstart", (e) => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.preventDefault();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const parent = btn.closest(".player-controls");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const player = parent.id === "player1Controls" ? "player1" : "player2";



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.activePlayer = player;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ns.selectedTypes[player] = btn.getAttribute("data-type");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }, { passive: false });

Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  ns.ui = {

Â  Â  Â  Â  Â  Â  Â  Â  updateUI,

Â  Â  Â  Â  Â  Â  Â  Â  setupTypeButtons,

Â  Â  Â  Â  Â  Â  };



Â  Â  Â  Â  Â  Â  // Ğ’Ñ‹Ğ·Ğ¾Ğ² setupTypeButtons Ğ¸ updateUI Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Game Ğ² main.js

Â  Â  Â  Â  Â  Â  document.addEventListener("DOMContentLoaded", () => {

Â  Â  Â  Â  Â  Â  Â  Â  ns.ui.setupTypeButtons();

Â  Â  Â  Â  Â  Â  Â  Â  ns.ui.updateUI();

Â  Â  Â  Â  Â  Â  Â  Â  ns.draw(); // ĞŸĞµÑ€Ğ²Ğ¾Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‚Ñ€Ğ¸ÑĞ¾Ğ²ĞºĞ° Ğ¿ÑƒÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»Ñ Ğ¸Ğ»Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ½Ğ¸Ñ‚Ğ¾Ğ²

Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  })(Game);

Â  Â  </script>

</body>

</html>



